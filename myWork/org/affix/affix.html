<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Affix</title>

		<style>
			*{margin:0;padding:0;}
			body{font-size:14px;}
			li{list-style:none;}
			.block{display:block;}
			.clearfix:after{content:'';clear:both;overflow:hidden;display:block;height:0;visibility:hidden;}
			#content{width:800px;margin:0 auto;}
			.affix_item{margin:20px 0;border:1px solid #ccc;}
			.floor_title{color:#08b;font-size:18px;}
			.product_item{float:left;border:none;width:230px;height:230px;}
			#menu{position:fixed;top:100px;left:50%;margin-left:400px;}
			.menu_item{padding:5px 0;color:#333;height:50px;line-height:50px;text-decoration:none;text-align:center;min-width:80px;}
			.menu_item.active,.menu_item:hover{color:#fff;background-color:#08b;}
		</style>
		<script src="../org/js/jquery-1.11.3.js"></script>
	</head>
	<body>
		<div class="menu" id="menu">
			<ul>
				<li><a href="#floor1" class="block active menu_item">一楼</a></li>
				<li><a href="#floor2" class="block menu_item">二楼</a></li>
				<li><a href="#floor3" class="block menu_item">三楼</a></li>
				<li><a href="#floor4" class="block menu_item">四楼</a></li>
				<li><a href="#floor5" class="block menu_item">五楼</a></li>
			</ul>
		</div>
		<div class="content" id="content">
			<h1>Affix</h1>
			<div class="affix_item" id="floor1">
				<h2 class="floor_title">一楼</h2>
				<div class="floor_content clearfix">
					<img src="1F.jpg" class="product_item">
					<img src="1F.jpg" class="product_item">
					<img src="1F.jpg" class="product_item">
					<img src="1F.jpg" class="product_item">
					<img src="1F.jpg" class="product_item">
					<img src="1F.jpg" class="product_item">
					<img src="1F.jpg" class="product_item">
					<img src="1F.jpg" class="product_item">
					<img src="1F.jpg" class="product_item">
				</div>
			</div>

			<div class="affix_item" id="floor2">
				<h2 class="floor_title">二楼</h2>
				<div class="floor_content clearfix">
					<img src="2F.jpg" class="product_item">
					<img src="2F.jpg" class="product_item">
					<img src="2F.jpg" class="product_item">
					<img src="2F.jpg" class="product_item">
					<img src="2F.jpg" class="product_item">
					<img src="2F.jpg" class="product_item">
					<img src="2F.jpg" class="product_item">
					<img src="2F.jpg" class="product_item">
					<img src="2F.jpg" class="product_item">
				</div>
			</div>
			<div class="affix_item" id="floor3">
				<h2 class="floor_title">三楼</h2>
				<div class="floor_content clearfix">
					<img src="3F.jpg" class="product_item">
					<img src="3F.jpg" class="product_item">
					<img src="3F.jpg" class="product_item">
					<img src="3F.jpg" class="product_item">
					<img src="3F.jpg" class="product_item">
					<img src="3F.jpg" class="product_item">
					<img src="3F.jpg" class="product_item">
					<img src="3F.jpg" class="product_item">
					<img src="3F.jpg" class="product_item">
				</div>
			</div>
			<div class="affix_item" id="floor4">
				<h2 class="floor_title">四楼</h2>
				<div class="floor_content clearfix">
					<img src="4F.png" class="product_item">
					<img src="4F.png" class="product_item">
					<img src="4F.png" class="product_item">
					<img src="4F.png" class="product_item">
					<img src="4F.png" class="product_item">
					<img src="4F.png" class="product_item">
					<img src="4F.png" class="product_item">
					<img src="4F.png" class="product_item">
					<img src="4F.png" class="product_item">
				</div>
			</div>
			<div class="affix_item" id="floor5">
				<h2 class="floor_title">五楼</h2>
				<div class="floor_content clearfix">
					<img src="5F.jpg" class="product_item">
					<img src="5F.jpg" class="product_item">
					<img src="5F.jpg" class="product_item">
					<img src="5F.jpg" class="product_item">
					<img src="5F.jpg" class="product_item">
					<img src="5F.jpg" class="product_item">
					<img src="5F.jpg" class="product_item">
					<img src="5F.jpg" class="product_item">
					<img src="5F.jpg" class="product_item">
				</div>
			</div>

		</div>
		<script>
			$(document).ready(function(){
				var menu = $("#menu");
			    var affix_item = $(".affix_item");
			    //缓存每一个floor的基本信息
				var floordata = [];
				affix_item.each(function(){
					var _this = $(this);
					var floorInfo = {};
					floorInfo.id = "#" + _this.attr("id");
					floorInfo.top = _this.offset().top;
					floordata.push(floorInfo);
				})
				var anchor = "";

				$(window).on("scroll",function(){
					var winScrollTop = $(document).scrollTop();
					//更新anchor数据
					floordata.forEach(function(floorInfo){
						if(winScrollTop>floorInfo.top-250){
							anchor = floorInfo.id;
						}else{
							return;
						}
					})
					
					var currentlink = $("#menu .active");
					if(anchor && currentlink.attr("href")!=anchor){
						currentlink.removeClass("active");
						menu.find("[href="+anchor+"]").addClass("active");
					}

				})


			})

		</script>
	</body>
</html>